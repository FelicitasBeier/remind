<!--
|  (C) 2006-2024 Potsdam Institute for Climate Impact Research (PIK)
|  authors, and contributors see CITATION.cff file. This file is part
|  of REMIND and licensed under AGPL-3.0-or-later. Under Section 7 of
|  AGPL-3.0, you are granted additional permissions described in the
|  REMIND License Exception, version 1.0 (see LICENSE file).
|  Contact: remind@pik-potsdam.de
-->

# Planetary Boundaries Indicators

## PB 1: Climate Change Indictator 


### Atmospheric CO2 concentration 

```{r}
showLinePlotsWithZones(
  data,
  "MAGICC7 AR6|Atmospheric Concentrations|CO2|67.0th Percentile",
  # from Richardson et al 2023
  safePB = 350,
  highRisk = 450
)
```


### Radiative Forcing 

```{r}
showLinePlotsWithZones(
  data,
  "MAGICC7 AR6|Effective Radiative Forcing|Basket|Anthropogenic|67.0th Percentile",
  # from Richardson et al 2023
  safePB = 1,
  highRisk = 1.5
)
```


### Global Mean Surface Temperature  

```{r}
showLinePlotsWithZones(
  data,
  "MAGICC7 AR6|Surface Temperature (GSAT)|67.0th Percentile",
  # similar to Beier et al 2025
  safePB = 1,
  highRisk = 2
)
```


## PB 2: Ozone 

<!-- van Vuuren et al (2025) used CMIP6 data, mostly over the Antarctica region  -->

## PB 3: Aerosols 

<!-- van Vuuren et al (2025) calculates something, and plug it into the FASST model  -->

## PB 4: Ocean Acidification 

```{r}
# This is the approach from van Vuuren, MAGICC also has net transport to ocean, maybe that is more exact?
a <- -5e-8 # vanVuuren value was given by Gt, so I changed to exponent from e-5 to e-8 to adjust to our values in Mt
b <- 8.0957

data2 <- data %>%
  dplyr::mutate(
    value = dplyr::if_else(
      variable == "Emi|CO2|Cumulated",
      a * value + b,
      value
    ),
    variable = dplyr::if_else(
      variable == "Emi|CO2|Cumulated",
      "pH",
      variable
    ),
    unit = dplyr::if_else(
      variable == "pH",
      "pH",
      unit
    )
  )

showLinePlotsWithZones(
  data2,
  "pH",
  # similar to Beier et al 2025
  safePB = 8.01,
  highRisk = 7.94,
  ylim = c(7.85,8.1)
)
```


## PB 5: Nitrogen Balance 

### Nitrogen Surplus 

```{r}
showLinePlotsWithZones(
  data,
  "Planetary Boundary|Nitrogen|Agricultural Nitrogen surplus",
  # # similar to Beier et al 2025, Richardson et al 2023 state 62, and upper limit 82
  safePB = 61,
  highRisk = 84
)
```



## PB 6: Phosphorus Balance 

## PB 7: Freshwater Use 

### Freshwater Consumption 

```{r}
showLinePlotsWithZones(
  data,
  "Planetary Boundary|Freshwater|Water consumption",
  # similar to Beier et al 2025 - why is this so low compared to other literature?
  safePB = 2800,
  highRisk = 4500
)
```


## PB 8: Land System Change / Land Cover 

### Forest Cover 

```{r}
showLinePlotsWithZones(
  data,
  "Planetary Boundary|Land|Forest cover",
  # similar to Beier et al 2025
  safePB = 4790,
  highRisk = 3449
)
```


  


## PB 9: Biosphere Integrity

<!-- 
  "Planetary Boundary|Biosphere|Share of intact land relative to total land area (unitless)",
  "Planetary Boundary|Biosphere|Share of land area that satisfies landscape target (unitless)", -->

### Share of intact land relative to total land area 

```{r}
showLinePlotsWithZones(
  data,
  "Planetary Boundary|Biosphere|Share of intact land relative to total land area",
  # similar to Beier et al 2025
  safePB = 0.6,
  highRisk = 0.5,
  ylim = c(0.35,0.7)
)
```


### Share of land area that satisfies landscape target 

```{r}
showLinePlotsWithZones(
  data,
  "Planetary Boundary|Biosphere|Share of land area that satisfies landscape target",
  # similar to Beier et al 2025 
  safePB = 1,
  #highRisk = 4500, ### RoSa: This has to be added until then it will fail. 
  ylim = c(0.7,1.05)
)
```

# MAgPIE

## Resources|Land Cover Change

```{r}
items <- c(
  "Resources|Land Cover Change|Cropland",
  "Resources|Land Cover Change|Pastures and Rangelands",
  "Resources|Land Cover Change|Forest",
  "Resources|Land Cover Change|Other Land",
  "Resources|Land Cover Change|Urban Area")
showAreaAndBarPlots(data, items, scales = "fixed")
```

### Resources|Land Cover Change|Forest

```{r}
showAreaAndBarPlotsPlus(data, "Resources|Land Cover Change|Forest", scales = "fixed")
```

### Resources|Land Cover Change|Forest|Planted Forest

```{r}
showAreaAndBarPlotsPlus(data, "Resources|Land Cover Change|Forest|Planted Forest", scales = "fixed")
```

### Resources|Land Cover Change|Forest|Natural Forest

```{r}
showAreaAndBarPlotsPlus(data, "Resources|Land Cover Change|Forest|Natural Forest", scales = "fixed")
```

### Resources|NetForestChange

```{r}
showLinePlots(data, "Resources|NetForestChange")
```

##  Productivity


### Productivity|Landuse Intensity Indicator Tau

```{r}
showLinePlots(data, "Productivity|Landuse Intensity Indicator Tau")
```

### Productivity|Yield|Bioenergy crops

```{r}
showLinePlots(data, "Productivity|Yield|Bioenergy crops")
```

### Productivity|Yield|Crops

```{r}
showLinePlots(data, "Productivity|Yield|Crops")
```

### Productivity|Yield|Forage

```{r}
showLinePlots(data, "Productivity|Yield|Forage")
```

### Productivity|Yield|Pasture

```{r}
showLinePlots(data, "Productivity|Yield|Pasture")
```

## Biodiversity

```{r results='asis'}
items <- c(
  "Biodiversity|BII",
  "Biodiversity|Biodiversity Hotspot BII",
  "Biodiversity|Cropland Landscapes BII",
  "Biodiversity|Key Biodiversity Area BII",
  "Biodiversity|BII in areas outside Biodiversity Hotspots, Intact Forest & Cropland Landscapes",
  "Biodiversity|Shannon crop area diversity index")
walk(items, function(v) {
  cat("###", v, "\n\n")
  showLinePlots(data, v, ylim = NULL, scales = "fixed")
  cat("\n\n")
})
```

## SDG

```{r results='asis'}
items <- c(
  "SDG|SDG02|Agricultural commodity price index wrt 2020",
  "SDG|SDG02|Food availability",
  "SDG|SDG02|Food expenditure share",
  "SDG|SDG02|Agricultural primary product expenditure share",
  "SDG|SDG15|Industrial and intentional biological fixation of N",
  "SDG|SDG12|Food waste",
  "SDG|SDG06|Agricultural water use")
walk(items, function(v) {
  cat("###", v, "\n\n")
  showLinePlots(data, v)
  cat("\n\n")
})
```

## Demand

### Areaplot - Split 1 - Selection

```{r}
items <- c(
  "Demand|Bioenergy crops",
  "Demand|Crops",
  "Demand|Fish",
  "Demand|Livestock products",
  "Demand|Secondary products")
showAreaAndBarPlots(data, items, scales = "fixed")
```

### Areaplot - Split 1

```{r}
showAreaAndBarPlotsPlus(data, "Demand", plusNum = 2, scales = "fixed")
```

### Lineplots - Split 1

```{r results='asis'}
items <- c(
  "Demand|Bioenergy crops",
  "Demand|Crop residues",
  "Demand|Crops",
  "Demand|Fish",
  "Demand|Forage",
  "Demand|Forest products",
  "Demand|Livestock products",
  "Demand|Pasture",
  "Demand|Secondary products"
  )
walk(items, function(v) {
  cat("####", v, "\n\n")
  showLinePlots(data, v)
  cat("\n\n")
})
```

### Areaplot - Split 2

```{r}
showAreaAndBarPlotsPlus(data, "Demand", plusNum = 1, scales = "fixed")
```

### Lineplots - Split 2

```{r results='asis'}
items <- c(
  "Demand|Agricultural Supply Chain Loss",
  "Demand|Bioenergy",
  "Demand|Domestic Balanceflow",
  "Demand|Feed",
  "Demand|Food",
  "Demand|Material",
  "Demand|Processing",
  "Demand|Seed"
  )
walk(items, function(v) {
  cat("####", v, "\n\n")
  showLinePlots(data, v)
  cat("\n\n")
})
```

## Nutrition

### Nutrition|Calorie Intake

```{r}
showAreaAndBarPlotsPlus(data, "Nutrition|Calorie Intake", scales = "fixed")
```

### Nutrition|Calorie Supply

```{r}
showAreaAndBarPlotsPlus(data, "Nutrition|Calorie Supply", scales = "fixed")
```

### Nutrition|Dietary Composition|Livestock Share

```{r}
showLinePlots(data, "Nutrition|Dietary Composition|Livestock Share")
```


## Prices|Food Expenditure Index

```{r}
showLinePlots(data, "Prices|Food Expenditure Index")
```

### Prices|Food Expenditure Index corrected for ghg costs

```{r}
showAreaAndBarPlots(
  data,
  vars = c(
    "Prices|Food Expenditure Index corrected for ghg costs|Livestock food products",
    "Prices|Food Expenditure Index corrected for ghg costs|Plant-based food products"),
  tot = "Prices|Food Expenditure Index corrected for ghg costs",
  scales = "fixed")
```

### Prices|Food Expenditure Index|Livestock food products

```{r}
showLinePlots(data, "Prices|Food Expenditure Index|Livestock food products")
```

### Prices|Food Expenditure Index|Plant-based food products

```{r}
showLinePlots(data, "Prices|Food Expenditure Index|Plant-based food products")
```
